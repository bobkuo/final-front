import{r as d,c as y,z as g,m as n,B as l,a3 as Q,q as h,f as t,l as p,F as x,A as V,u,a5 as m,Q as f}from"./index-DO5f-SfG.js";import{Q as q,a as P,b as L}from"./QTable-DOvw17XO.js";import{Q as k}from"./QToolbar-DqZebzv-.js";import{Q as A}from"./QPage-D9Y_Mj3f.js";import{o as B}from"./order--uJNXXwZ.js";import"./QList-BPRAz_bQ.js";import"./rtl-DFPa-2ov.js";import"./QChip-HCaIfIq3.js";import"./QItemLabel-CjX_BwTP.js";import"./QMenu-DonDdjDz.js";import"./position-engine-C7s2rKqd.js";import"./selection--6S1X6zf.js";import"./format-BvkBI9bc.js";import"./use-fullscreen-PBmg_8Ob.js";const C={style:{"overflow-x":"auto","max-width":"100%"}},K={__name:"OrdersPage",setup(j){const b=Q(),i=d([]),v=[{name:"orderid",label:"訂單編號",field:"_id"},{name:"createdAt",label:"建立日期",field:e=>new Date(e.createdAt).toLocaleString(),sortable:!0},{name:"user",label:"使用者",field:e=>e.user.account,sortable:!0},{name:"cartobj",label:"商品",field:"cart",sortable:!1},{name:"totalPrice",label:"總金額",field:e=>e.cart.reduce((r,a)=>r+a.product.price*a.quantity,0)},{name:"cartobj",label:"商品",field:"cart",sortable:!1},{name:"totalPrice",label:"總金額",field:e=>e.cart.reduce((r,a)=>r+a.product.price*a.quantity,0)},{name:"cartobj",label:"商品",field:"cart",sortable:!1},{name:"totalPrice",label:"總金額",field:e=>e.cart.reduce((r,a)=>r+a.product.price*a.quantity,0)}];(async()=>{try{const{data:e}=await B.getAll();i.value=e.result}catch(e){console.error("Error fetching orders:",e),b.notify({type:"negative",message:"無法載入訂單資料"})}})();const o=d(""),s=d(""),w=y(()=>i.value.filter(e=>{const r=!o.value||e._id.toLowerCase().includes(o.value.toLowerCase()),a=!s.value||e.createdAt.toLowerCase().includes(s.value.toLowerCase());return r&&a}));return(e,r)=>(n(),g(A,{class:"flex flex-center"},{default:l(()=>[h("div",C,[t(q,{separator:"cell",rows:w.value,columns:v,"row-key":"_id",class:"q-table--dense",pagination:{rowsPerPage:10}},{top:l(()=>[t(k,null,{default:l(()=>[t(m,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=a=>o.value=a),dense:"",outlined:"",clearable:"",placeholder:"搜尋訂單編號"},{prepend:l(()=>[t(f,{name:"search"})]),_:1},8,["modelValue"]),t(L),t(m,{modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=a=>s.value=a),dense:"",outlined:"",clearable:"",placeholder:"搜尋建立日期"},{prepend:l(()=>[t(f,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),"body-cell-cartobj":l(a=>[t(P,{props:a,style:{width:"300px"}},{default:l(()=>[(n(!0),p(x,null,V(a.row.cart,(c,_)=>(n(),p("div",{key:_},u(c.product.name)+" ("+u(c.quantity)+") - $"+u(c.product.price),1))),128))]),_:2},1032,["props"])]),_:1},8,["rows"])])]),_:1}))}};export{K as default};
