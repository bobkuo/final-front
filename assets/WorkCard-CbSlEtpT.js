import{Q as he}from"./QChip-B_15ocKa.js";import{P as ye,aC as I,aD as we,aE as _e,aF as be,g as re,r as V,c as y,V as Se,W as ke,aG as je,aH as Te,aI as Ce,w as z,H as U,aJ as J,aK as K,aL as xe,h as Z,aM as Pe,Z as Me,M as Oe,aN as X,s as Ee,o as qe,a3 as Be,a2 as De,aO as He,l as Y,m as W,q as r,f as p,B as d,a6 as v,aw as Le,F as ee,A as Ie,z as We,a8 as C,u as x,a7 as A,ax as te,x as Ae,aP as Qe,a4 as P}from"./index-BCeI5mYc.js";import{v as Ve,a as oe,u as $e,p as ae,b as Ne,c as Re,d as Fe,r as ie,s as Ge}from"./position-engine-iCi9YNeN.js";import{c as se}from"./selection-DD7Phqiu.js";import{g as ne}from"./index-CH_iu5NA.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=ye({name:"QTooltip",inheritAttrs:!1,props:{...$e,...be,...I,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...I.transitionShow,default:"jump-down"},transitionHide:{...I.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:oe},self:{type:String,default:"top middle",validator:oe},offset:{type:Array,default:()=>[14,14],validator:Ve},scrollTarget:_e,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...we],setup(e,{slots:a,emit:i,attrs:t}){let s,m;const f=re(),{proxy:{$q:l}}=f,u=V(null),h=V(!1),M=y(()=>ae(e.anchor,l.lang.rtl)),O=y(()=>ae(e.self,l.lang.rtl)),E=y(()=>e.persistent!==!0),{registerTick:T,removeTick:q}=Se(),{registerTimeout:b}=ke(),{transitionProps:k,transitionStyle:B}=je(e),{localScrollTarget:S,changeScrollEvent:D,unconfigureScrollTarget:n}=Ne(e,F),{anchorEl:o,canShow:g,anchorEvents:w}=Re({showing:h,configureAnchorEl:pe}),{show:le,hide:H}=Te({showing:h,canShow:g,handleShow:ue,handleHide:de,hideOnRouteChange:E,processOnMount:!0});Object.assign(w,{delayShow:fe,delayHide:ge});const{showPortal:$,hidePortal:N,renderPortal:ce}=Ce(f,u,me,"tooltip");if(l.platform.is.mobile===!0){const c={anchorEl:o,innerRef:u,onClickOutside(_){return H(_),_.target.classList.contains("q-dialog__backdrop")&&Oe(_),!0}},L=y(()=>e.modelValue===null&&e.persistent!==!0&&h.value===!0);z(L,_=>{(_===!0?Fe:ie)(c)}),U(()=>{ie(c)})}function ue(c){$(),T(()=>{m=new MutationObserver(()=>j()),m.observe(u.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),j(),F()}),s===void 0&&(s=z(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,j)),b(()=>{$(!0),i("show",c)},e.transitionDuration)}function de(c){q(),N(),R(),b(()=>{N(!0),i("hide",c)},e.transitionDuration)}function R(){m!==void 0&&(m.disconnect(),m=void 0),s!==void 0&&(s(),s=void 0),n(),J(w,"tooltipTemp")}function j(){Ge({targetEl:u.value,offset:e.offset,anchorEl:o.value,anchorOrigin:M.value,selfOrigin:O.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function fe(c){if(l.platform.is.mobile===!0){se(),document.body.classList.add("non-selectable");const L=o.value,_=["touchmove","touchcancel","touchend","click"].map(G=>[L,G,"delayHide","passiveCapture"]);K(w,"tooltipTemp",_)}b(()=>{le(c)},e.delay)}function ge(c){l.platform.is.mobile===!0&&(J(w,"tooltipTemp"),se(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),b(()=>{H(c)},e.hideDelay)}function pe(){if(e.noParentEvent===!0||o.value===null)return;const c=l.platform.is.mobile===!0?[[o.value,"touchstart","delayShow","passive"]]:[[o.value,"mouseenter","delayShow","passive"],[o.value,"mouseleave","delayHide","passive"]];K(w,"anchor",c)}function F(){if(o.value!==null||e.scrollTarget!==void 0){S.value=xe(o.value,e.scrollTarget);const c=e.noParentEvent===!0?j:H;D(S.value,c)}}function ve(){return h.value===!0?Z("div",{...t,ref:u,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",t.class],style:[t.style,B.value],role:"tooltip"},Me(a.default)):null}function me(){return Z(Pe,k.value,ve)}return U(R),Object.assign(f.proxy,{updatePosition:j}),ce}}),Ue=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Je=Ue?window.navigator:void 0;function Ke(){const e=Ee(!1),a=re();return a&&qe(()=>{e.value=!0},a),e}function Ze(e){const a=Ke();return y(()=>(a.value,!!e()))}function Xe(e={},a={}){const{navigator:i=Je}=a,t=i,s=Ze(()=>t&&"canShare"in t);return{isSupported:s,share:async(f={})=>{if(s.value){const l={...X(e),...X(f)};let u=!1;if(t.canShare&&(u=t.canShare(l)),u)return t.share(l)}}}}const Ye={class:"project-image"},et=["src","alt"],tt={class:"row full-width items-center"},ot={class:"col"},at={class:"row justify-end q-gutter-xs"},it={class:"col-4"},st={class:"row justify-end"},nt={class:"project-content"},rt={class:"project-category"},lt={class:"project-title"},ct={class:"project-description"},ut=["src","alt"],dt={__name:"WorkCard",props:{project:{type:Object,required:!0,validator:e=>e&&typeof e=="object"&&"id"in e&&"title"in e&&"category"in e&&"description"in e&&"image"in e},isReverse:{type:Boolean,default:!1}},setup(e){const a=Be(),i=De(),t=e,{project:s,isReverse:m}=He(t),f=V(!1),l=()=>{f.value=!0},u=()=>{f.value=!1},h=y(()=>`${window.location.origin}${window.location.pathname}#/work#project-${t.project.id}`),{share:M,isSupported:O}=Xe({title:`${s.value.title} - Judy的創作世界`,text:`來看看 Judy 的作品：${s.value.description}`,url:h.value}),E=async()=>{if(O.value)try{await M(),a.notify({type:"positive",message:"分享成功！",position:"top",timeout:2e3,icon:"share"})}catch(n){n.name!=="AbortError"&&(console.error("分享失敗:",n),T())}else T()},T=async()=>{try{navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(h.value),a.notify({type:"positive",message:"連結已複製到剪貼簿！",position:"top",timeout:2e3,icon:"content_copy"})):a.dialog({title:"手動複製連結",message:"請手動複製以下連結：",prompt:{model:h.value,type:"text",readonly:!0},ok:"關閉",persistent:!0})}catch(n){console.error("複製失敗:",n),a.notify({type:"negative",message:"無法複製連結",position:"top",timeout:2e3})}},q=n=>{const g=n.currentTarget.querySelector(".project-content");ne.to(g,{y:-10,duration:.3})},b=n=>{const g=n.currentTarget.querySelector(".project-content");ne.to(g,{y:0,duration:.3})},k=y(()=>!i.isLoggedIn||!i.favorites?!1:i.favorites.includes(t.project.id)),B=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入收藏"});return}try{k.value?(await P.favorites({work:t.project.id,action:"remove"}),i.favorites=i.favorites.filter(n=>n!==t.project.id),a.notify({type:"info",message:"已移除收藏",icon:"favorite_border",position:"top",timeout:2e3})):(await P.favorites({work:t.project.id,action:"add"}),i.favorites.push(t.project.id),a.notify({type:"positive",message:"已加入收藏",icon:"favorite",position:"top",timeout:2e3}))}catch(n){console.error("收藏操作失敗:",n),a.notify({type:"negative",message:k.value?"無法移除收藏":"無法加入收藏",position:"top",timeout:2e3})}},S=y(()=>!i.isLoggedIn||!i.goods?!1:i.goods.includes(t.project.id)),D=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入按讚"});return}try{S.value?(await P.goods({work:t.project.id,action:"remove"}),i.goods=i.goods.filter(n=>n!==t.project.id)):(await P.goods({work:t.project.id,action:"add"}),i.goods.push(t.project.id))}catch(n){console.error("按讚操作失敗:",n),a.notify({type:"negative",message:S.value?"無法移除按讚":"無法加入按讚",position:"top",timeout:2e3})}};return(n,o)=>(W(),Y(ee,null,[r("div",{class:Ae(["project-item bg-judy-1",{reverse:v(m)}]),onMouseenter:q,onMouseleave:b},[r("div",Ye,[p(te,{class:"my-card",flat:"",bordered:""},{default:d(()=>[r("img",{src:v(s).image,alt:v(s).title,class:"main-image",onClick:l},null,8,et),p(Le,{align:v(m)?"left":"right"},{default:d(()=>[r("div",tt,[r("div",ot,[r("div",at,[(W(!0),Y(ee,null,Ie(v(s).tags,(g,w)=>(W(),We(he,{square:"",color:`judy-${2+w%5}`,"text-color":"white",icon:"tag",key:g},{default:d(()=>[C(x(g),1)]),_:2},1032,["color"]))),128))])]),r("div",it,[r("div",st,[p(A,{flat:"",round:"",color:"red",icon:S.value?"favorite":"favorite_border",onClick:D},{default:d(()=>[p(Q,null,{default:d(()=>o[1]||(o[1]=[C("喜歡按讚",-1)])),_:1,__:[1]})]),_:1},8,["icon"]),p(A,{flat:"",round:"",color:"teal",icon:k.value?"bookmark":"bookmark_border",onClick:B},{default:d(()=>[p(Q,null,{default:d(()=>o[2]||(o[2]=[C("加入書籤",-1)])),_:1,__:[2]})]),_:1},8,["icon"]),p(A,{flat:"",round:"",color:"primary",icon:"share",onClick:E},{default:d(()=>[p(Q,null,{default:d(()=>o[3]||(o[3]=[C("分享作品",-1)])),_:1,__:[3]})]),_:1})])])])]),_:1},8,["align"])]),_:1})]),r("div",nt,[r("div",rt,"－"+x(v(s).category),1),r("h3",lt,x(v(s).title),1),r("p",ct,x(v(s).description),1),r("button",{class:"project-link",onClick:l},o[4]||(o[4]=[r("span",null,"放大看作品",-1),r("svg",{class:"arrow-icon",viewBox:"0 0 24 24"},[r("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)]))])],34),p(Qe,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=g=>f.value=g),maximized:"","transition-show":"none","transition-hide":"none"},{default:d(()=>[p(te,{class:"image-dialog-card bg-black"},{default:d(()=>[r("div",{class:"image-container",onClick:u},[r("img",{src:v(s).image,alt:v(s).title,class:"fullsize-image",onClick:u},null,8,ut)])]),_:1})]),_:1},8,["modelValue"])],64))}},yt=ze(dt,[["__scopeId","data-v-241d68b7"]]);export{yt as W};
