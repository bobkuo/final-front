import{Q as pe}from"./QChip-CvfuoUUQ.js";import{P as he,aC as H,aD as ye,aE as we,aF as je,g as ne,r as A,c as m,V as be,W as Se,aG as ke,aH as Te,aI as Ce,w as F,H as G,aJ as z,aK as U,aL as _e,h as J,aM as xe,Z as Pe,M as Me,aN as K,s as Oe,o as Ee,a3 as qe,a2 as Be,l as Z,m as L,q as n,f as v,B as d,aw as De,F as X,A as He,z as Le,a8 as _,u as x,a7 as I,ax as Y,x as Ie,aO as We,a4 as P}from"./index-C3dO1gcQ.js";import{v as Ae,a as ee,u as Qe,p as te,b as Ve,c as $e,d as Ne,r as oe,s as Re}from"./position-engine-CdqZCEZC.js";import{c as ae}from"./selection-Ib6bhzhw.js";import{g as ie}from"./index-CH_iu5NA.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W=he({name:"QTooltip",inheritAttrs:!1,props:{...Qe,...je,...H,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...H.transitionShow,default:"jump-down"},transitionHide:{...H.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:ee},self:{type:String,default:"top middle",validator:ee},offset:{type:Array,default:()=>[14,14],validator:Ae},scrollTarget:we,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...ye],setup(e,{slots:a,emit:i,attrs:t}){let c,p;const h=ne(),{proxy:{$q:s}}=h,f=A(null),w=A(!1),M=m(()=>te(e.anchor,s.lang.rtl)),C=m(()=>te(e.self,s.lang.rtl)),O=m(()=>e.persistent!==!0),{registerTick:E,removeTick:b}=be(),{registerTimeout:j}=Se(),{transitionProps:S,transitionStyle:q}=ke(e),{localScrollTarget:o,changeScrollEvent:r,unconfigureScrollTarget:g}=Ve(e,N),{anchorEl:u,canShow:se,anchorEvents:k}=$e({showing:w,configureAnchorEl:ge}),{show:re,hide:B}=Te({showing:w,canShow:se,handleShow:ce,handleHide:ue,hideOnRouteChange:O,processOnMount:!0});Object.assign(k,{delayShow:de,delayHide:fe});const{showPortal:Q,hidePortal:V,renderPortal:le}=Ce(h,f,me,"tooltip");if(s.platform.is.mobile===!0){const l={anchorEl:u,innerRef:f,onClickOutside(y){return B(y),y.target.classList.contains("q-dialog__backdrop")&&Me(y),!0}},D=m(()=>e.modelValue===null&&e.persistent!==!0&&w.value===!0);F(D,y=>{(y===!0?Ne:oe)(l)}),G(()=>{oe(l)})}function ce(l){Q(),E(()=>{p=new MutationObserver(()=>T()),p.observe(f.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),T(),N()}),c===void 0&&(c=F(()=>s.screen.width+"|"+s.screen.height+"|"+e.self+"|"+e.anchor+"|"+s.lang.rtl,T)),j(()=>{Q(!0),i("show",l)},e.transitionDuration)}function ue(l){b(),V(),$(),j(()=>{V(!0),i("hide",l)},e.transitionDuration)}function $(){p!==void 0&&(p.disconnect(),p=void 0),c!==void 0&&(c(),c=void 0),g(),z(k,"tooltipTemp")}function T(){Re({targetEl:f.value,offset:e.offset,anchorEl:u.value,anchorOrigin:M.value,selfOrigin:C.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function de(l){if(s.platform.is.mobile===!0){ae(),document.body.classList.add("non-selectable");const D=u.value,y=["touchmove","touchcancel","touchend","click"].map(R=>[D,R,"delayHide","passiveCapture"]);U(k,"tooltipTemp",y)}j(()=>{re(l)},e.delay)}function fe(l){s.platform.is.mobile===!0&&(z(k,"tooltipTemp"),ae(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),j(()=>{B(l)},e.hideDelay)}function ge(){if(e.noParentEvent===!0||u.value===null)return;const l=s.platform.is.mobile===!0?[[u.value,"touchstart","delayShow","passive"]]:[[u.value,"mouseenter","delayShow","passive"],[u.value,"mouseleave","delayHide","passive"]];U(k,"anchor",l)}function N(){if(u.value!==null||e.scrollTarget!==void 0){o.value=_e(u.value,e.scrollTarget);const l=e.noParentEvent===!0?T:B;r(o.value,l)}}function ve(){return w.value===!0?J("div",{...t,ref:f,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",t.class],style:[t.style,q.value],role:"tooltip"},Pe(a.default)):null}function me(){return J(xe,S.value,ve)}return G($),Object.assign(h.proxy,{updatePosition:T}),le}}),Ge=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ze=Ge?window.navigator:void 0;function Ue(){const e=Oe(!1),a=ne();return a&&Ee(()=>{e.value=!0},a),e}function Je(e){const a=Ue();return m(()=>(a.value,!!e()))}function Ke(e={},a={}){const{navigator:i=ze}=a,t=i,c=Je(()=>t&&"canShare"in t);return{isSupported:c,share:async(h={})=>{if(c.value){const s={...K(e),...K(h)};let f=!1;if(t.canShare&&(f=t.canShare(s)),f)return t.share(s)}}}}const Ze={class:"project-image"},Xe=["src","alt"],Ye={class:"row full-width items-center"},et={class:"col"},tt={class:"row justify-end q-gutter-xs"},ot={class:"col-4"},at={class:"row justify-end"},it={class:"project-content"},nt={class:"project-category"},st={class:"project-title"},rt={class:"project-description"},lt=["src","alt"],ct={__name:"WorkCard",props:{project:{type:Object,required:!0,validator:e=>e&&typeof e=="object"&&"id"in e&&"title"in e&&"category"in e&&"description"in e&&"image"in e},isReverse:{type:Boolean,default:!1}},setup(e){const a=qe(),i=Be(),t=e,c=A(!1),p=()=>{c.value=!0},h=()=>{c.value=!1},s=m(()=>`${window.location.origin}${window.location.pathname}#/work#project-${t.project.id}`),{share:f,isSupported:w}=Ke({title:m(()=>`${t.project.title} - Judy的創作世界`),text:m(()=>`來看看 Judy 的作品：${t.project.description}`),url:s.value}),M=async()=>{if(w.value)try{await f(),a.notify({type:"positive",message:"分享成功！",position:"top",timeout:2e3,icon:"share"})}catch(o){o.name!=="AbortError"&&(console.error("分享失敗:",o),C())}else C()},C=async()=>{try{navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(s.value),a.notify({type:"positive",message:"連結已複製到剪貼簿！",position:"top",timeout:2e3,icon:"content_copy"})):a.dialog({title:"手動複製連結",message:"請手動複製以下連結：",prompt:{model:s.value,type:"text",readonly:!0},ok:"關閉",persistent:!0})}catch(o){console.error("複製失敗:",o),a.notify({type:"negative",message:"無法複製連結",position:"top",timeout:2e3})}},O=o=>{const g=o.currentTarget.querySelector(".project-content");ie.to(g,{y:-10,duration:.3})},E=o=>{const g=o.currentTarget.querySelector(".project-content");ie.to(g,{y:0,duration:.3})},b=m(()=>!i.isLoggedIn||!i.favorites?!1:i.favorites.includes(t.project.id)),j=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入收藏"});return}try{b.value?(await P.favorites({work:t.project.id,action:"remove"}),i.favorites=i.favorites.filter(o=>o!==t.project.id),a.notify({type:"info",message:"已移除收藏",icon:"favorite_border",position:"top",timeout:2e3})):(await P.favorites({work:t.project.id,action:"add"}),i.favorites.push(t.project.id),a.notify({type:"positive",message:"已加入收藏",icon:"favorite",position:"top",timeout:2e3}))}catch(o){console.error("收藏操作失敗:",o),a.notify({type:"negative",message:b.value?"無法移除收藏":"無法加入收藏",position:"top",timeout:2e3})}},S=m(()=>!i.isLoggedIn||!i.goods?!1:i.goods.includes(t.project.id)),q=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入按讚"});return}try{S.value?(await P.goods({work:t.project.id,action:"remove"}),i.goods=i.goods.filter(o=>o!==t.project.id)):(await P.goods({work:t.project.id,action:"add"}),i.goods.push(t.project.id))}catch(o){console.error("按讚操作失敗:",o),a.notify({type:"negative",message:S.value?"無法移除按讚":"無法加入按讚",position:"top",timeout:2e3})}};return(o,r)=>(L(),Z(X,null,[n("div",{class:Ie(["project-item bg-judy-1",{reverse:e.isReverse}]),onMouseenter:O,onMouseleave:E},[n("div",Ze,[v(Y,{class:"my-card",flat:"",bordered:""},{default:d(()=>[n("img",{src:e.project.image,alt:e.project.title,class:"main-image",onClick:p},null,8,Xe),v(De,{align:e.isReverse?"left":"right"},{default:d(()=>[n("div",Ye,[n("div",et,[n("div",tt,[(L(!0),Z(X,null,He(e.project.tags,(g,u)=>(L(),Le(pe,{square:"",color:`judy-${2+u%5}`,"text-color":"white",icon:"tag",key:g},{default:d(()=>[_(x(g),1)]),_:2},1032,["color"]))),128))])]),n("div",ot,[n("div",at,[v(I,{flat:"",round:"",color:"red",icon:S.value?"favorite":"favorite_border",onClick:q},{default:d(()=>[v(W,null,{default:d(()=>r[1]||(r[1]=[_("喜歡按讚",-1)])),_:1,__:[1]})]),_:1},8,["icon"]),v(I,{flat:"",round:"",color:"teal",icon:b.value?"bookmark":"bookmark_border",onClick:j},{default:d(()=>[v(W,null,{default:d(()=>r[2]||(r[2]=[_("加入書籤",-1)])),_:1,__:[2]})]),_:1},8,["icon"]),v(I,{flat:"",round:"",color:"primary",icon:"share",onClick:M},{default:d(()=>[v(W,null,{default:d(()=>r[3]||(r[3]=[_("分享作品",-1)])),_:1,__:[3]})]),_:1})])])])]),_:1},8,["align"])]),_:1})]),n("div",it,[n("div",nt,"－"+x(e.project.category),1),n("h3",st,x(e.project.title),1),n("p",rt,x(e.project.description),1),n("button",{class:"project-link",onClick:p},r[4]||(r[4]=[n("span",null,"放大看作品",-1),n("svg",{class:"arrow-icon",viewBox:"0 0 24 24"},[n("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)]))])],34),v(We,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=g=>c.value=g),maximized:"","transition-show":"none","transition-hide":"none"},{default:d(()=>[v(Y,{class:"image-dialog-card bg-black"},{default:d(()=>[n("div",{class:"image-container",onClick:h},[n("img",{src:e.project.image,alt:e.project.title,class:"fullsize-image",onClick:h},null,8,lt)])]),_:1})]),_:1},8,["modelValue"])],64))}},pt=Fe(ct,[["__scopeId","data-v-b994b4ef"]]);export{pt as W};
