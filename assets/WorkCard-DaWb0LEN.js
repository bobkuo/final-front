import{Q as he}from"./QChip-JUS-V2ru.js";import{P as ye,aC as I,aD as we,aE as _e,aF as Se,g as re,r as V,c as y,V as be,W as ke,aG as je,aH as Te,aI as Ce,w as z,H as U,aJ as J,aK as K,aL as xe,h as Z,aM as Pe,Z as Me,M as Oe,aN as X,s as Ee,o as qe,a3 as Be,a2 as De,aO as He,l as Y,m as W,q as r,f as v,B as g,a6 as h,aw as Le,F as ee,A as Ie,z as We,a8 as C,u as x,a7 as A,ax as te,x as Ae,aP as Qe,a4 as P}from"./index-Drry56Kt.js";import{v as Ve,a as oe,u as $e,p as ae,b as Ne,c as Re,d as Fe,r as ie,s as Ge}from"./position-engine-Bw7ND2VZ.js";import{c as se}from"./selection-Biq6ja7B.js";import{g as ne}from"./index-CH_iu5NA.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=ye({name:"QTooltip",inheritAttrs:!1,props:{...$e,...Se,...I,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...I.transitionShow,default:"jump-down"},transitionHide:{...I.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:oe},self:{type:String,default:"top middle",validator:oe},offset:{type:Array,default:()=>[14,14],validator:Ve},scrollTarget:_e,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...we],setup(e,{slots:a,emit:i,attrs:o}){let t,f;const p=re(),{proxy:{$q:l}}=p,d=V(null),_=V(!1),M=y(()=>ae(e.anchor,l.lang.rtl)),O=y(()=>ae(e.self,l.lang.rtl)),j=y(()=>e.persistent!==!0),{registerTick:E,removeTick:q}=be(),{registerTimeout:m}=ke(),{transitionProps:B,transitionStyle:S}=je(e),{localScrollTarget:T,changeScrollEvent:s,unconfigureScrollTarget:c}=Ne(e,F),{anchorEl:n,canShow:D,anchorEvents:b}=Re({showing:_,configureAnchorEl:ve}),{show:le,hide:H}=Te({showing:_,canShow:D,handleShow:ue,handleHide:de,hideOnRouteChange:j,processOnMount:!0});Object.assign(b,{delayShow:fe,delayHide:ge});const{showPortal:$,hidePortal:N,renderPortal:ce}=Ce(p,d,me,"tooltip");if(l.platform.is.mobile===!0){const u={anchorEl:n,innerRef:d,onClickOutside(w){return H(w),w.target.classList.contains("q-dialog__backdrop")&&Oe(w),!0}},L=y(()=>e.modelValue===null&&e.persistent!==!0&&_.value===!0);z(L,w=>{(w===!0?Fe:ie)(u)}),U(()=>{ie(u)})}function ue(u){$(),E(()=>{f=new MutationObserver(()=>k()),f.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),k(),F()}),t===void 0&&(t=z(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,k)),m(()=>{$(!0),i("show",u)},e.transitionDuration)}function de(u){q(),N(),R(),m(()=>{N(!0),i("hide",u)},e.transitionDuration)}function R(){f!==void 0&&(f.disconnect(),f=void 0),t!==void 0&&(t(),t=void 0),c(),J(b,"tooltipTemp")}function k(){Ge({targetEl:d.value,offset:e.offset,anchorEl:n.value,anchorOrigin:M.value,selfOrigin:O.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function fe(u){if(l.platform.is.mobile===!0){se(),document.body.classList.add("non-selectable");const L=n.value,w=["touchmove","touchcancel","touchend","click"].map(G=>[L,G,"delayHide","passiveCapture"]);K(b,"tooltipTemp",w)}m(()=>{le(u)},e.delay)}function ge(u){l.platform.is.mobile===!0&&(J(b,"tooltipTemp"),se(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),m(()=>{H(u)},e.hideDelay)}function ve(){if(e.noParentEvent===!0||n.value===null)return;const u=l.platform.is.mobile===!0?[[n.value,"touchstart","delayShow","passive"]]:[[n.value,"mouseenter","delayShow","passive"],[n.value,"mouseleave","delayHide","passive"]];K(b,"anchor",u)}function F(){if(n.value!==null||e.scrollTarget!==void 0){T.value=xe(n.value,e.scrollTarget);const u=e.noParentEvent===!0?k:H;s(T.value,u)}}function pe(){return _.value===!0?Z("div",{...o,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",o.class],style:[o.style,S.value],role:"tooltip"},Me(a.default)):null}function me(){return Z(Pe,B.value,pe)}return U(R),Object.assign(p.proxy,{updatePosition:k}),ce}}),Ue=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Je=Ue?window.navigator:void 0;function Ke(){const e=Ee(!1),a=re();return a&&qe(()=>{e.value=!0},a),e}function Ze(e){const a=Ke();return y(()=>(a.value,!!e()))}function Xe(e={},a={}){const{navigator:i=Je}=a,o=i,t=Ze(()=>o&&"canShare"in o);return{isSupported:t,share:async(p={})=>{if(t.value){const l={...X(e),...X(p)};let d=!1;if(o.canShare&&(d=o.canShare(l)),d)return o.share(l)}}}}const Ye={class:"project-image"},et=["src","alt"],tt={class:"row full-width items-center"},ot={class:"col"},at={class:"row justify-end q-gutter-xs"},it={class:"col-4"},st={class:"row justify-end"},nt={class:"project-content"},rt={class:"project-category"},lt={class:"project-title"},ct={class:"project-description"},ut=["src","alt"],dt={__name:"WorkCard",props:{project:{type:Object,required:!0,validator:e=>e&&typeof e=="object"&&"id"in e&&"title"in e&&"category"in e&&"description"in e&&"image"in e},isReverse:{type:Boolean,default:!1}},setup(e){const a=Be(),i=De(),{project:o}=He(t),t=e,f=V(!1),p=()=>{f.value=!0},l=()=>{f.value=!1},d=y(()=>`${window.location.origin}${window.location.pathname}#/work#project-${t.project.id}`),{share:_,isSupported:M}=Xe({title:`${o.value.title} - Judy的創作世界`,text:`來看看 Judy 的作品：${o.value.description}`,url:d.value}),O=async()=>{if(M.value)try{await _(),a.notify({type:"positive",message:"分享成功！",position:"top",timeout:2e3,icon:"share"})}catch(s){s.name!=="AbortError"&&(console.error("分享失敗:",s),j())}else j()},j=async()=>{try{navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(d.value),a.notify({type:"positive",message:"連結已複製到剪貼簿！",position:"top",timeout:2e3,icon:"content_copy"})):a.dialog({title:"手動複製連結",message:"請手動複製以下連結：",prompt:{model:d.value,type:"text",readonly:!0},ok:"關閉",persistent:!0})}catch(s){console.error("複製失敗:",s),a.notify({type:"negative",message:"無法複製連結",position:"top",timeout:2e3})}},E=s=>{const n=s.currentTarget.querySelector(".project-content");ne.to(n,{y:-10,duration:.3})},q=s=>{const n=s.currentTarget.querySelector(".project-content");ne.to(n,{y:0,duration:.3})},m=y(()=>!i.isLoggedIn||!i.favorites?!1:i.favorites.includes(t.project.id)),B=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入收藏"});return}try{m.value?(await P.favorites({work:t.project.id,action:"remove"}),i.favorites=i.favorites.filter(s=>s!==t.project.id),a.notify({type:"info",message:"已移除收藏",icon:"favorite_border",position:"top",timeout:2e3})):(await P.favorites({work:t.project.id,action:"add"}),i.favorites.push(t.project.id),a.notify({type:"positive",message:"已加入收藏",icon:"favorite",position:"top",timeout:2e3}))}catch(s){console.error("收藏操作失敗:",s),a.notify({type:"negative",message:m.value?"無法移除收藏":"無法加入收藏",position:"top",timeout:2e3})}},S=y(()=>!i.isLoggedIn||!i.goods?!1:i.goods.includes(t.project.id)),T=async()=>{if(!i.isLoggedIn){a.dialog({title:"需要登入",message:"請先登入帳號才能加入按讚"});return}try{S.value?(await P.goods({work:t.project.id,action:"remove"}),i.goods=i.goods.filter(s=>s!==t.project.id)):(await P.goods({work:t.project.id,action:"add"}),i.goods.push(t.project.id))}catch(s){console.error("按讚操作失敗:",s),a.notify({type:"negative",message:S.value?"無法移除按讚":"無法加入按讚",position:"top",timeout:2e3})}};return(s,c)=>(W(),Y(ee,null,[r("div",{class:Ae(["project-item bg-judy-1",{reverse:e.isReverse}]),onMouseenter:E,onMouseleave:q},[r("div",Ye,[v(te,{class:"my-card",flat:"",bordered:""},{default:g(()=>[r("img",{src:h(o).image,alt:h(o).title,class:"main-image",onClick:p},null,8,et),v(Le,{align:e.isReverse?"left":"right"},{default:g(()=>[r("div",tt,[r("div",ot,[r("div",at,[(W(!0),Y(ee,null,Ie(h(o).tags,(n,D)=>(W(),We(he,{square:"",color:`judy-${2+D%5}`,"text-color":"white",icon:"tag",key:n},{default:g(()=>[C(x(n),1)]),_:2},1032,["color"]))),128))])]),r("div",it,[r("div",st,[v(A,{flat:"",round:"",color:"red",icon:S.value?"favorite":"favorite_border",onClick:T},{default:g(()=>[v(Q,null,{default:g(()=>c[1]||(c[1]=[C("喜歡按讚",-1)])),_:1,__:[1]})]),_:1},8,["icon"]),v(A,{flat:"",round:"",color:"teal",icon:m.value?"bookmark":"bookmark_border",onClick:B},{default:g(()=>[v(Q,null,{default:g(()=>c[2]||(c[2]=[C("加入書籤",-1)])),_:1,__:[2]})]),_:1},8,["icon"]),v(A,{flat:"",round:"",color:"primary",icon:"share",onClick:O},{default:g(()=>[v(Q,null,{default:g(()=>c[3]||(c[3]=[C("分享作品",-1)])),_:1,__:[3]})]),_:1})])])])]),_:1},8,["align"])]),_:1})]),r("div",nt,[r("div",rt,"－"+x(h(o).category),1),r("h3",lt,x(h(o).title),1),r("p",ct,x(h(o).description),1),r("button",{class:"project-link",onClick:p},c[4]||(c[4]=[r("span",null,"放大看作品",-1),r("svg",{class:"arrow-icon",viewBox:"0 0 24 24"},[r("path",{d:"M5 12h14M12 5l7 7-7 7"})],-1)]))])],34),v(Qe,{modelValue:f.value,"onUpdate:modelValue":c[0]||(c[0]=n=>f.value=n),maximized:"","transition-show":"none","transition-hide":"none"},{default:g(()=>[v(te,{class:"image-dialog-card bg-black"},{default:g(()=>[r("div",{class:"image-container",onClick:l},[r("img",{src:h(o).image,alt:h(o).title,class:"fullsize-image",onClick:l},null,8,ut)])]),_:1})]),_:1},8,["modelValue"])],64))}},yt=ze(dt,[["__scopeId","data-v-2ae9942e"]]);export{yt as W};
