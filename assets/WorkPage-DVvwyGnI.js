import{r as m,c as h,w as j,o as E,ad as I,l as n,m as s,q as a,p as k,z as w,f as p,ae as N,B as x,u as f,F as W,A as S,Q as $,af as z,a3 as H}from"./index-Drry56Kt.js";import{Q as R,a as A}from"./QCarousel-BKqcI1fR.js";import{Q as F}from"./QBtnToggle-WY5kS76C.js";import{g as M}from"./index-CH_iu5NA.js";import{S as O}from"./ScrollTrigger-C4gmGO9R.js";import{W as U}from"./WorkCard-DaWb0LEN.js";import{s as D}from"./series-LHslhfhp.js";import{w as L}from"./work-DMrj1F5f.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./touch-BjYP5sR0.js";import"./selection-Biq6ja7B.js";import"./use-fullscreen-C-cdd5Wb.js";import"./QChip-JUS-V2ru.js";import"./position-engine-Bw7ND2VZ.js";const G={class:"projects-section"},J={class:"container"},K={class:"q-pa-md"},X={key:0,class:"loading-container"},Z={class:"absolute-bottom custom-caption"},ee={class:"text-h2"},te={class:"text-subtitle1"},oe={key:2,class:"row justify-center q-mt-md"},se={key:0,class:"row justify-center"},ae={class:"col-12"},re={class:"section-title"},ie={key:0,class:"projects-grid col-12 col-md-10"},ne=["id"],le={key:1,class:"no-works-container"},ce={class:"no-works-message"},de={__name:"WorkPage",setup(ue){M.registerPlugin(O);const d=I(),_=H(),i=m([]),v=m([]),l=m(!0),r=m(""),Q=h(()=>i.value.map(e=>({label:e.name,value:e._id}))),u=h(()=>i.value.find(e=>e._id===r.value)),g=h(()=>v.value.filter(e=>e.category===r.value)),V=e=>({id:e._id,title:e.name,category:u.value?.name||"未分類",description:e.content||"暫無描述",image:e.images?.[0]||"https://via.placeholder.com/600x400?text=No+Image",tags:e.tags||[],statistics:e.statistics||{}}),y=async()=>{const e=d.hash;if(e&&e.startsWith("#project-")){const o=e.replace("#project-",""),t=v.value.find(c=>c._id===o);t?(r.value=t.category,await z(),setTimeout(()=>{b(o,t)},300)):_.notify({type:"warning",message:"找不到指定的作品",position:"top",timeout:2e3,icon:"warning"})}},b=(e,o)=>{const t=document.getElementById(`project-${e}`);if(t){const c=t.getBoundingClientRect(),C=c.height,T=window.innerHeight,q=c.top+window.pageYOffset-50-T/2+C/2;window.scrollTo({top:Math.max(0,q),behavior:"smooth"}),_.notify({type:"info",message:`正在查看：${o.name}`,position:"top",timeout:3e3,icon:"visibility",actions:[{label:"關閉",color:"white",handler:()=>{}}]})}};j(()=>d.hash,(e,o)=>{e&&e!==o&&e.startsWith("#project-")&&y()}),j(r,(e,o)=>{e!==o&&e&&(console.log("切換到系列:",u.value?.name),console.log("該系列作品數量:",g.value.length))});const B=async()=>{try{l.value=!0;const e=await D.get();i.value=e.data.series,i.value.length>0&&(r.value=i.value[0]._id)}catch(e){console.error("Error fetching series:",e)}finally{l.value=!1}},P=async()=>{try{l.value=!0;const e=await L.get();v.value=e.data.works}catch(e){console.error("Error fetching works:",e)}finally{l.value=!1}};return E(async()=>{await B(),await P(),d.hash&&d.hash.startsWith("#project-")?y():i.value.length>0&&(r.value=i.value[0]._id)}),(e,o)=>(s(),n("div",G,[a("div",J,[a("div",K,[l.value?(s(),n("div",X,[p(N,{size:"50px",color:"primary"}),o[2]||(o[2]=a("p",{class:"q-mt-md"},"載入中...",-1))])):(s(),w(R,{key:1,modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=t=>r.value=t),"transition-prev":"slide-right","transition-next":"slide-left",animated:"","control-color":"primary",class:"rounded-borders"},{default:x(()=>[(s(!0),n(W,null,S(i.value,t=>(s(),w(A,{key:t._id,name:t._id,"img-src":t.cover},{default:x(()=>[a("div",Z,[a("div",ee,f(t.name),1),a("div",te,f(t.description),1)])]),_:2},1032,["name","img-src"]))),128))]),_:1},8,["modelValue"])),!l.value&&i.value.length>0?(s(),n("div",oe,[p(F,{modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=t=>r.value=t),options:Q.value,"toggle-color":"judy-2",color:"white","text-color":"judy-2",unelevated:""},null,8,["modelValue","options"])])):k("",!0)]),u.value?(s(),n("div",se,[a("div",ae,[a("h2",re,f(u.value.name)+" - 作品集",1)]),g.value.length>0?(s(),n("div",ie,[(s(!0),n(W,null,S(g.value,(t,c)=>(s(),n("div",{key:t._id,id:`project-${t._id}`,class:"project-section"},[p(U,{project:V(t),"is-reverse":c%2===1},null,8,["project","is-reverse"])],8,ne))),128))])):(s(),n("div",le,[a("div",ce,[p($,{name:"image",size:"4rem",color:"grey-5"}),o[3]||(o[3]=a("h3",null,"此系列暫無作品",-1)),o[4]||(o[4]=a("p",null,"請選擇其他系列查看作品",-1))])]))])):k("",!0)])]))}},be=Y(de,[["__scopeId","data-v-ae1858c2"]]);export{be as default};
